<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Just People Meeting</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --navy: #0a1628;
    --navy-mid: #132040;
    --navy-light: #1e3560;
    --accent: #1a56db;
    --accent-light: #3b82f6;
    --gold: #c8a96e;
    --white: #ffffff;
    --off-white: #f8f8f5;
    --gray: #8a9bb8;
    --gray-light: #e8ecf5;
    --danger: #e53e3e;
    --success: #38a169;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'DM Sans', sans-serif; background: var(--off-white); min-height: 100vh; overflow-x: hidden; color: var(--navy); }

  .screen { display: none; min-height: 100vh; width: 100%; flex-direction: column; align-items: center; justify-content: center; padding: 20px; position: relative; animation: fadeIn 0.4s ease; }
  .screen.active { display: flex; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

  /* NAME SCREEN */
  #screen-name { background: var(--navy); background-image: radial-gradient(ellipse at 30% 20%, rgba(26,86,219,0.25) 0%, transparent 60%), radial-gradient(ellipse at 70% 80%, rgba(200,169,110,0.15) 0%, transparent 60%); }
  .name-card { background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 52px 48px; max-width: 440px; width: 100%; text-align: center; backdrop-filter: blur(12px); }
  .logo-mark { width: 56px; height: 56px; background: var(--accent); border-radius: 14px; display: flex; align-items: center; justify-content: center; margin: 0 auto 28px; font-family: 'Playfair Display', serif; font-size: 22px; color: white; font-weight: 700; letter-spacing: -1px; }
  h1.game-title { font-family: 'Playfair Display', serif; font-size: 28px; color: var(--white); font-weight: 600; letter-spacing: -0.5px; margin-bottom: 8px; }
  .game-subtitle { font-size: 14px; color: var(--gray); margin-bottom: 36px; font-weight: 300; letter-spacing: 0.3px; }
  input[type="text"] { width: 100%; background: rgba(255,255,255,0.07); border: 1px solid rgba(255,255,255,0.15); border-radius: 10px; padding: 14px 18px; font-size: 16px; color: var(--white); font-family: 'DM Sans', sans-serif; outline: none; transition: border-color 0.2s; margin-bottom: 16px; }
  input[type="text"]::placeholder { color: rgba(255,255,255,0.3); }
  input[type="text"]:focus { border-color: var(--accent-light); }
  .btn-primary { width: 100%; background: var(--accent); border: none; border-radius: 10px; padding: 15px 24px; font-size: 15px; font-weight: 500; color: white; cursor: pointer; font-family: 'DM Sans', sans-serif; transition: all 0.2s; letter-spacing: 0.2px; }
  .btn-primary:hover { background: #1d4ed8; transform: translateY(-1px); }
  .error-msg { font-size: 13px; color: #fc8181; margin-bottom: 14px; min-height: 18px; }

  /* HOME SCREEN */
  #screen-home { background: var(--off-white); justify-content: flex-start; padding-top: 0; }
  .home-header { width: 100%; background: var(--navy); padding: 28px 28px 40px; text-align: left; position: relative; overflow: hidden; }
  .home-header::after { content: ''; position: absolute; bottom: -1px; left: 0; right: 0; height: 28px; background: var(--off-white); border-radius: 28px 28px 0 0; }
  .home-header-inner { max-width: 480px; margin: 0 auto; }
  .greeting { font-size: 13px; color: var(--gray); margin-bottom: 4px; font-weight: 300; letter-spacing: 0.5px; text-transform: uppercase; }
  .greeting-name { font-family: 'Playfair Display', serif; font-size: 30px; color: white; font-weight: 600; letter-spacing: -0.5px; }
  .home-body { width: 100%; max-width: 480px; padding: 28px 20px; flex: 1; }
  .play-card { background: var(--navy); border-radius: 20px; padding: 32px 28px; text-align: center; margin-bottom: 24px; position: relative; overflow: hidden; }
  .play-card::before { content: ''; position: absolute; top: -40px; right: -40px; width: 180px; height: 180px; background: radial-gradient(circle, rgba(26,86,219,0.4) 0%, transparent 70%); border-radius: 50%; pointer-events: none; }
  .play-card-label { font-size: 12px; color: var(--gray); letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 18px; }
  .streak-display { display: flex; align-items: baseline; justify-content: center; gap: 8px; margin-bottom: 24px; }
  .streak-number { font-family: 'Playfair Display', serif; font-size: 52px; color: var(--gold); font-weight: 700; line-height: 1; }
  .streak-label { font-size: 13px; color: var(--gray); font-weight: 300; }
  .btn-play { background: var(--accent); border: none; border-radius: 12px; padding: 16px 48px; font-size: 16px; font-weight: 500; color: white; cursor: pointer; font-family: 'DM Sans', sans-serif; transition: all 0.2s; letter-spacing: 0.2px; }
  .btn-play:hover { background: #1d4ed8; transform: translateY(-1px); box-shadow: 0 8px 24px rgba(26,86,219,0.35); }
  .section-title { font-size: 11px; font-weight: 500; letter-spacing: 1.8px; text-transform: uppercase; color: var(--gray); margin-bottom: 14px; }
  .percentile-badge { background: white; border: 1px solid var(--gray-light); border-radius: 12px; padding: 14px 18px; margin-bottom: 24px; display: flex; align-items: center; gap: 12px; }
  .percentile-icon { width: 36px; height: 36px; background: var(--accent); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0; }
  .percentile-text { font-size: 14px; color: var(--navy); font-weight: 400; }
  .percentile-text strong { font-weight: 600; }
  .leaderboard-card { background: white; border-radius: 16px; overflow: hidden; border: 1px solid var(--gray-light); }
  .lb-header { background: var(--navy-mid); padding: 14px 18px; display: flex; justify-content: space-between; align-items: center; }
  .lb-header span { font-size: 12px; font-weight: 500; letter-spacing: 1px; text-transform: uppercase; color: var(--gray); }
  .lb-row { display: grid; grid-template-columns: 28px 1fr auto auto; gap: 12px; align-items: center; padding: 12px 18px; border-bottom: 1px solid var(--gray-light); }
  .lb-row:last-child { border-bottom: none; }
  .lb-row.current-user { background: rgba(26,86,219,0.05); }
  .lb-rank { font-size: 12px; font-weight: 600; color: var(--gray); text-align: center; }
  .lb-rank.top-3 { color: var(--gold); }
  .lb-name { font-size: 14px; font-weight: 500; color: var(--navy); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .lb-name.me { color: var(--accent); }
  .lb-score { font-family: 'Playfair Display', serif; font-size: 18px; font-weight: 600; color: var(--navy); }
  .lb-date { font-size: 11px; color: var(--gray); }
  .lb-empty { padding: 28px; text-align: center; color: var(--gray); font-size: 14px; }

  /* GAME SCREEN */
  #screen-game { background: var(--off-white); justify-content: flex-start; padding: 0; overflow: hidden; }
  .game-top-bar { width: 100%; background: var(--navy); padding: 18px 24px 16px; display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; }
  .streak-pill { background: rgba(255,255,255,0.1); border-radius: 100px; padding: 6px 16px; display: flex; align-items: center; gap: 6px; font-size: 13px; color: white; font-weight: 500; }
  .streak-pill-num { font-family: 'Playfair Display', serif; font-size: 18px; color: var(--gold); font-weight: 700; line-height: 1; }
  .timer-circle { width: 42px; height: 42px; position: relative; }
  .timer-svg { transform: rotate(-90deg); width: 42px; height: 42px; }
  .timer-bg { fill: none; stroke: rgba(255,255,255,0.1); stroke-width: 3; }
  .timer-arc { fill: none; stroke: var(--accent-light); stroke-width: 3; stroke-linecap: round; transition: stroke-dashoffset 0.9s linear, stroke 0.3s; }
  .timer-num { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; font-family: 'Playfair Display', serif; font-size: 15px; font-weight: 700; color: white; }
  .diff-badge { display: inline-flex; align-items: center; padding: 3px 10px; border-radius: 100px; font-size: 11px; font-weight: 500; letter-spacing: 0.5px; text-transform: uppercase; }
  .diff-badge.easy { background: rgba(56,161,105,0.2); color: #38a169; }
  .diff-badge.medium { background: rgba(237,137,54,0.2); color: #ed8936; }
  .diff-badge.hard { background: rgba(229,62,62,0.2); color: #e53e3e; }
  .diff-badge.extreme { background: rgba(159,122,234,0.2); color: #9f7aea; }
  .game-question-area { width: 100%; padding: 20px 20px 14px; flex-shrink: 0; max-width: 560px; align-self: center; }
  .question-text { font-family: 'Playfair Display', serif; font-size: 19px; color: var(--navy); font-weight: 600; line-height: 1.45; text-align: center; min-height: 80px; display: flex; align-items: center; justify-content: center; }
  .photos-area { width: 100%; flex: 1; display: flex; align-items: center; justify-content: center; padding: 0 0 20px; position: relative; overflow: hidden; }
  .photos-row { display: flex; gap: 12px; width: 100%; max-width: 560px; padding: 0 16px; position: relative; align-items: center; }
  .photo-card { flex: 1; background: white; border-radius: 18px; overflow: hidden; border: 2px solid transparent; cursor: pointer; transition: all 0.2s; position: relative; box-shadow: 0 2px 12px rgba(0,0,0,0.08); user-select: none; }
  .photo-card:hover { border-color: var(--accent-light); transform: translateY(-4px); box-shadow: 0 12px 32px rgba(26,86,219,0.2); }
  .photo-card img { width: 100%; aspect-ratio: 3/4; object-fit: cover; object-position: top center; display: block; pointer-events: none; background: var(--navy-light); }
  .photo-card-name { padding: 10px 12px; font-size: 13px; font-weight: 500; color: var(--navy); text-align: center; }
  .swipe-arrow { position: absolute; top: 45%; transform: translateY(-50%); background: var(--navy); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 10; font-size: 16px; transition: all 0.2s; box-shadow: 0 4px 16px rgba(10,22,40,0.3); flex-shrink: 0; }
  .swipe-arrow.left { margin-right: 4px; }
  .swipe-arrow.right { margin-left: 4px; }
  .swipe-arrow:hover { background: var(--accent); }
  .hint-text { font-size: 12px; color: var(--gray); text-align: center; padding: 0 20px 16px; letter-spacing: 0.3px; flex-shrink: 0; }
  .photo-card.ok { border-color: var(--success) !important; box-shadow: 0 0 0 3px rgba(56,161,105,0.3) !important; }
  .photo-card.bad { border-color: var(--danger) !important; box-shadow: 0 0 0 3px rgba(229,62,62,0.3) !important; }

  /* RESULT SCREENS */
  #screen-correct { background: var(--navy); background-image: radial-gradient(ellipse at 50% 0%, rgba(56,161,105,0.3) 0%, transparent 60%); }
  #screen-wrong { background: var(--navy); background-image: radial-gradient(ellipse at 50% 0%, rgba(229,62,62,0.2) 0%, transparent 60%); }
  .result-icon { width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 36px; margin-bottom: 24px; animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
  @keyframes popIn { 0% { transform: scale(0); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
  .result-icon.correct { background: rgba(56,161,105,0.2); border: 2px solid rgba(56,161,105,0.5); }
  .result-icon.wrong { background: rgba(229,62,62,0.2); border: 2px solid rgba(229,62,62,0.4); }
  .result-title { font-family: 'Playfair Display', serif; font-size: 32px; color: white; font-weight: 700; margin-bottom: 10px; letter-spacing: -0.5px; }
  .result-sub { font-size: 15px; color: var(--gray); margin-bottom: 32px; font-weight: 300; text-align: center; max-width: 300px; line-height: 1.6; }
  .streak-reveal { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); border-radius: 14px; padding: 20px 40px; text-align: center; margin-bottom: 32px; }
  .streak-reveal-num { font-family: 'Playfair Display', serif; font-size: 56px; color: var(--gold); font-weight: 700; line-height: 1; }
  .streak-reveal-label { font-size: 12px; color: var(--gray); text-transform: uppercase; letter-spacing: 1.5px; margin-top: 4px; }
  .correct-reveal { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); border-radius: 14px; padding: 16px 20px; display: flex; align-items: center; gap: 14px; max-width: 320px; margin-bottom: 28px; }
  .correct-reveal img { width: 52px; height: 52px; object-fit: cover; object-position: top; border-radius: 10px; flex-shrink: 0; background: var(--navy-light); }
  .correct-reveal-text { font-size: 14px; color: white; }
  .correct-reveal-text small { display: block; color: var(--gray); font-size: 12px; margin-top: 2px; }

  /* CONFETTI */
  .confetti-container { position: fixed; inset: 0; pointer-events: none; z-index: 100; overflow: hidden; }
  .confetto { position: absolute; top: -20px; animation: confettiFall linear forwards; border-radius: 2px; }
  @keyframes confettiFall { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 80% { opacity: 1; } 100% { transform: translateY(110vh) rotate(720deg); opacity: 0; } }

  .loading-dots { display: flex; gap: 6px; }
  .loading-dots span { width: 8px; height: 8px; border-radius: 50%; background: var(--gray); animation: dotBounce 1.2s ease-in-out infinite; }
  .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
  .loading-dots span:nth-child(3) { animation-delay: 0.4s; }
  @keyframes dotBounce { 0%, 80%, 100% { transform: scale(0.7); opacity: 0.5; } 40% { transform: scale(1); opacity: 1; } }

  @media (max-width: 400px) { .question-text { font-size: 16px; } .name-card { padding: 36px 24px; } }
</style>
</head>
<body>

<!-- NAME SCREEN -->
<div id="screen-name" class="screen active">
  <div class="name-card">
    <div class="logo-mark">JP</div>
    <h1 class="game-title">Just People Meeting</h1>
    <p class="game-subtitle">How well do you know the faces behind the firm?</p>
    <input type="text" id="name-input" placeholder="Enter your first name" maxlength="24" autocomplete="off" />
    <p class="error-msg" id="name-error"></p>
    <button class="btn-primary" onclick="submitName()">Let's Play ‚Üí</button>
  </div>
</div>

<!-- HOME SCREEN -->
<div id="screen-home" class="screen">
  <div class="home-header">
    <div class="home-header-inner">
      <p class="greeting">Welcome back</p>
      <p class="greeting-name" id="home-greeting">Player</p>
    </div>
  </div>
  <div class="home-body">
    <div class="play-card">
      <p class="play-card-label">Your Best Streak</p>
      <div class="streak-display">
        <span class="streak-number" id="home-best-streak">0</span>
        <span class="streak-label">in a row</span>
      </div>
      <button class="btn-play" id="home-play-btn" onclick="startGame()">Play</button>
    </div>
    <div id="percentile-section" style="display:none;" class="percentile-badge">
      <div class="percentile-icon">üèÜ</div>
      <p class="percentile-text">You're better than <strong id="percentile-num">‚Äî</strong>% of all players</p>
    </div>
    <p class="section-title">Leaderboard</p>
    <div class="leaderboard-card" id="leaderboard-container">
      <div class="lb-empty" style="display:flex;align-items:center;justify-content:center;gap:8px;padding:28px;">
        <div class="loading-dots"><span></span><span></span><span></span></div>
      </div>
    </div>
  </div>
</div>

<!-- GAME SCREEN -->
<div id="screen-game" class="screen">
  <div class="game-top-bar">
    <div class="streak-pill">
      <span>Streak</span>
      <span class="streak-pill-num" id="game-streak-num">0</span>
    </div>
    <span class="diff-badge easy" id="diff-badge">Easy</span>
    <div class="timer-circle">
      <svg class="timer-svg" viewBox="0 0 42 42">
        <circle class="timer-bg" cx="21" cy="21" r="18"/>
        <circle class="timer-arc" id="timer-arc" cx="21" cy="21" r="18" stroke-dasharray="113.1" stroke-dashoffset="0"/>
      </svg>
      <div class="timer-num" id="timer-num">10</div>
    </div>
  </div>
  <div class="game-question-area" style="align-self:stretch;">
    <p class="question-text" id="question-text">Loading...</p>
  </div>
  <div class="photos-area">
    <div class="photos-row" id="photos-row">
      <button class="swipe-arrow left" onclick="selectPhoto(0)" title="Choose left (‚Üê)">‚Üê</button>
      <div class="photo-card" id="photo-card-0" onclick="selectPhoto(0)">
        <img id="photo-img-0" src="" alt="" />
        <div class="photo-card-name" id="photo-name-0"></div>
      </div>
      <div class="photo-card" id="photo-card-1" onclick="selectPhoto(1)">
        <img id="photo-img-1" src="" alt="" />
        <div class="photo-card-name" id="photo-name-1"></div>
      </div>
      <button class="swipe-arrow right" onclick="selectPhoto(1)" title="Choose right (‚Üí)">‚Üí</button>
    </div>
  </div>
  <p class="hint-text">Tap a photo ‚Äî or swipe / use arrows</p>
</div>

<!-- CORRECT SCREEN -->
<div id="screen-correct" class="screen">
  <div class="result-icon correct">‚úì</div>
  <h2 class="result-title">Nailed it.</h2>
  <p class="result-sub" id="correct-sub">You identified them correctly!</p>
  <div class="streak-reveal">
    <div class="streak-reveal-num" id="correct-streak">1</div>
    <div class="streak-reveal-label">streak</div>
  </div>
  <button class="btn-primary" style="max-width:280px;" onclick="nextQuestion()">Next ‚Üí</button>
</div>

<!-- WRONG SCREEN -->
<div id="screen-wrong" class="screen">
  <div class="result-icon wrong">‚úó</div>
  <h2 class="result-title">Better next time.</h2>
  <div class="correct-reveal">
    <img id="correct-person-img" src="" alt="" />
    <div class="correct-reveal-text">
      <span id="correct-person-name">‚Äî</span>
      <small id="correct-person-title">‚Äî</small>
    </div>
  </div>
  <p class="result-sub">Streak ended at <strong style="color:var(--gold)" id="wrong-streak-num">0</strong></p>
  <button class="btn-primary" style="max-width:280px;" onclick="goHome()">Back to Home</button>
</div>

<div class="confetti-container" id="confetti-container"></div>

<script>
// ============================================================
// EXECUTIVES DATA
// ============================================================
const EXECS = [
  // OPERATING COMMITTEE (13)
  { id:'jamie-dimon', name:'Jamie Dimon', title:'Chairman & CEO', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmc/jpmorgan-chase-and-co/who-we-are/our-leadership/headshots/headshot-jamiedimon.png', joinYear:2005, education:'Tufts; Harvard Business School', facts:['Was fired by Sandy Weill at Smith Barney before building his Wall Street empire','Survived emergency throat surgery while running the firm in 2020','Has written annual shareholder letters that move markets and shape policy debate'] },
  { id:'ashley-bacon', name:'Ashley Bacon', title:'Chief Risk Officer', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-abacon.jpg', joinYear:1994, education:'Oxford University', facts:['Oxford-educated Brit who has spent over 30 years managing the firm\'s risk','Joined the firm the same year as Jennifer Piepszak ‚Äî a 30-year parallel career','Oversees risk management for the largest bank in the United States'] },
  { id:'jeremy-barnum', name:'Jeremy Barnum', title:'Chief Financial Officer', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-jeremy-barnum.jpg', joinYear:1999, education:'Yale University', facts:['His father was once CEO of J.P. Morgan ‚Äî making this a true Wall Street dynasty','Became firmwide CFO in 2021 after leading the CIB finance function','Leads quarterly earnings calls that move global bond and equity markets'] },
  { id:'lori-beer', name:'Lori Beer', title:'Global Chief Information Officer', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-lbeer.jpg', joinYear:2014, education:'University of Louisville', facts:['Oversees a $17 billion annual technology budget ‚Äî larger than most tech company revenues','Manages 62,000+ technologists across the globe','Named to Fortune\'s Most Powerful Women list multiple times'] },
  { id:'tim-berry', name:'Tim Berry', title:'Head of Corporate Responsibility', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-tim-berry.jpg', joinYear:2007, education:'University of Virginia', facts:['Leads the firm\'s $30 billion racial equity commitment ‚Äî one of the largest in US corporate history','Based in Washington D.C., serving as the firm\'s link to government and civil society','Chairs the firm\'s Mid-Atlantic region while running global philanthropy'] },
  { id:'mary-callahan-erdoes', name:'Mary Callahan Erdoes', title:'CEO, Asset & Wealth Management', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/ir/ceo-letters/2024/awm/awm-thumbnail.png', joinYear:1996, education:'Georgetown; Harvard Business School', facts:['Oversees more than $3 trillion in client assets','Has been named to Forbes Most Powerful Women list for 15+ consecutive years','Joined the firm the same year the Dolly the sheep was cloned ‚Äî and has been a firm fixture ever since'] },
  { id:'stacey-friedman', name:'Stacey Friedman', title:'General Counsel', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-sfriedman.jpg', joinYear:2012, education:'Columbia; Harvard Law School', facts:['Leads the legal function for one of the most litigated institutions in the world','Joined from Sullivan & Cromwell, one of Wall Street\'s premier law firms','Navigated the firm through a historic wave of post-financial-crisis regulatory change'] },
  { id:'teresa-heitsenrether', name:'Teresa Heitsenrether', title:'Chief Data & Analytics Officer', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-heitsenrether.jpg', joinYear:1995, education:'Princeton; Wharton', facts:['Has spent her entire 30-year career at the firm ‚Äî joined as an analyst, rose to the Operating Committee','Co-leads one of the largest AI deployments in global financial services','Joined the Operating Committee the same year ChatGPT was released to the public'] },
  { id:'marianne-lake', name:'Marianne Lake', title:'CEO, Consumer & Community Banking', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-marianne-lake.jpg', joinYear:1999, education:'University of Birmingham (UK)', facts:['Previously the firmwide CFO from 2013 to 2019 during peak profitability','British-born executive who has been with the firm for over 25 years','Consistently named among the top potential successors to Jamie Dimon'] },
  { id:'robin-leopold', name:'Robin Leopold', title:'Head of Human Resources', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-rleopold.jpg', joinYear:2012, education:'University of Michigan', facts:['Oversees talent strategy for 300,000+ employees ‚Äî a larger workforce than the US Army active duty force','Led the firm\'s return-to-office policy ‚Äî one of the most watched corporate decisions in recent years','Joined from Time Warner, bringing media-world talent instincts to banking'] },
  { id:'douglas-petno', name:'Douglas B. Petno', title:'Co-CEO, Commercial & Investment Bank', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-dpetno.jpg', joinYear:1994, education:'U of Colorado; UVA Darden', facts:['Has been with the firm for over 30 years ‚Äî joined the same year as Jennifer Piepszak and Ashley Bacon','Built Commercial Banking into the #1 US middle-market lender under his prior leadership','Now co-leads a business that is the #1 investment bank globally by revenue'] },
  { id:'jennifer-piepszak', name:'Jennifer Piepszak', title:'Chief Operating Officer', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-jpiepszak.jpg', joinYear:1994, education:'Western University (Canada)', facts:['Consistently cited as one of the leading internal candidates to succeed Jamie Dimon','Has held major P&L roles across every major consumer business at the firm','A Canadian who joined the firm in 1994 and has spent her entire career there'] },
  { id:'troy-rohrbaugh', name:'Troy Rohrbaugh', title:'Co-CEO, Commercial & Investment Bank', group:'Operating Committee', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-troy.jpg', joinYear:2002, education:'U of Michigan; U of Chicago Booth', facts:['Led the Markets division to record revenues in 2020 as volatility spiked','Co-leads a business generating more investment banking fees than any rival globally','Promoted to the Operating Committee the same year the firm opened its landmark 270 Park Avenue headquarters'] },
  // BOARD (11)
  { id:'linda-bammann', name:'Linda B. Bammann', title:'Board Director (since 2013)', group:'Board of Directors', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-lindabbammann.jpg', joinYear:2013, education:'U of Michigan; U of Chicago', facts:['Former Deputy Head of Risk at the firm itself ‚Äî a rare inside-out board perspective','Chairs the Risk Committee for the largest bank in the US','One of the longest-serving board directors ‚Äî over a decade of continuous oversight'] },
  { id:'michele-g-buck', name:'Michele G. Buck', title:'Board Director (since 2025)', group:'Board of Directors', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-michele-g-buck.jpg', joinYear:2025, education:'Shippensburg; Wake Forest', facts:['CEO of Hershey ‚Äî the first woman to lead the chocolate giant in its 130-year history','Joined the board in 2025 as one of two brand-new directors that year','Brings consumer brand insights from a company whose products appear in virtually every US household'] },
  { id:'stephen-burke', name:'Stephen B. Burke', title:'Board Director (since 2004)', group:'Board of Directors', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-stephenbburke.jpg', joinYear:2004, education:'Colgate; Harvard Business School', facts:['Has served on the board for over 20 years ‚Äî the longest-tenured non-Dimon director','Former CEO of NBCUniversal and COO of Comcast ‚Äî brings media and cable empire experience','Joined the board the same year Facebook was founded in a Harvard dorm room'] },
  { id:'alicia-boler-davis', name:'Alicia Boler Davis', title:'Board Director (since 2023)', group:'Board of Directors', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-alicia-boler-davis.jpg', joinYear:2023, education:'Northwestern; U of Michigan', facts:['EVP of Global Customer Fulfillment at Amazon ‚Äî overseeing delivery to hundreds of millions of customers','Previously a senior VP at General Motors overseeing quality and manufacturing','One of the few Black women serving on a major US bank board'] },
  { id:'alex-gorsky', name:'Alex Gorsky', title:'Board Director (since 2022)', group:'Board of Directors', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-alex-gorsky.jpg', joinYear:2022, education:'West Point; Wharton', facts:['West Point graduate and former US Army Captain ‚Äî brings military discipline to boardroom','Led J&J\'s COVID-19 vaccine that became one of three mass-distributed globally','Oversaw J&J during the talc litigation that fundamentally reshaped product liability law'] },
  { id:'mellody-hobson', name:'Mellody Hobson', title:'Board Director (since 2018)', group:'Board of Directors', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-mellody-hobson.jpg', joinYear:2018, education:'Princeton University', facts:['Co-CEO of Ariel Investments ‚Äî one of the largest Black-owned investment firms in the US','Married to George Lucas ‚Äî the creator of Star Wars ‚Äî bridging finance and Hollywood','Her TED Talk on "color blindness" in corporate America has been viewed millions of times'] },
  { id:'phebe-novakovic', name:'Phebe N. Novakovic', title:'Board Director (since 2020)', group:'Board of Directors', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-phebe-novakovic.jpg', joinYear:2020, education:'Smith College; Wharton', facts:['Former CIA officer whose classified work remains largely undisclosed','CEO of General Dynamics ‚Äî the company behind Gulfstream jets and nuclear submarines','Named to Fortune\'s Most Powerful Women list for more than a decade'] },
  { id:'virginia-rometty', name:'Virginia M. Rometty', title:'Board Director (since 2020)', group:'Board of Directors', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-ginni.jpg', joinYear:2020, education:'Northwestern University', facts:['First female CEO in IBM\'s 100+ year history','Led IBM\'s Watson AI ‚Äî one of the first AI brands to become a household name (famous for winning Jeopardy!)','Joined the board the same year the COVID-19 pandemic transformed the global technology landscape'] },
  { id:'brad-d-smith', name:'Brad D. Smith', title:'Board Director (since 2025)', group:'Board of Directors', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-brad-d-smith.png', joinYear:2025, education:'Marshall University; Aquinas College', facts:['After retiring from Intuit, became President of his own alma mater ‚Äî Marshall University','Led Intuit\'s transformation from a CD-ROM software company into a $100B+ fintech platform','Joined the board in 2025 alongside Michele G. Buck ‚Äî a simultaneous debut'] },
  { id:'mark-weinberger', name:'Mark A. Weinberger', title:'Board Director (since 2024)', group:'Board of Directors', photo:'https://www.jpmorganchase.com/content/dam/jpmorganchase/images/headshots/headshot-mark-weinberger.jpg', joinYear:2024, education:'Miami U; Case Western (law); George Washington U', facts:['Former US Treasury Assistant Secretary ‚Äî brings rare government insider tax expertise','Led EY, one of the Big Four accounting firms, from 2013 to 2019','Joined the board the same year the firm inaugurated its iconic new 270 Park Avenue global headquarters'] },
  // CHASE MANAGEMENT (~11 to reach ~20 total Chase execs with Marianne Lake + Operating overlap)
  { id:'allison-beer', name:'Allison Beer', title:'CEO, Card Services & Connected Commerce', group:'Chase Management', photo:'https://media.chase.com/content/dam/chase-ux/en/structured-images/leadership/allison-beer.jpg', joinYear:2016, education:'Yale University', facts:['Oversees 59 million+ active card accounts ‚Äî the industry leader in US credit card sales','Helped launch the Sapphire Reserve card ‚Äî one of the most hyped card launches in history','Transitioned from leading the Chase mobile app transformation to running the entire card portfolio'] },
  { id:'ben-walter', name:'Ben Walter', title:'CEO, Chase Business Banking', group:'Chase Management', photo:'https://media.chase.com/content/dam/chase-ux/en/structured-images/leadership/ben-walter.jpg', joinYear:2021, education:'Dartmouth; Columbia Business School', facts:['Chase serves 7 million small businesses ‚Äî the #1 primary bank for US small business owners','Joined Chase the same year the pandemic triggered a historic surge in new US business formation','Previously ran a specialty insurance business for small companies ‚Äî now banks them instead'] },
  { id:'bori-cox', name:'Bori Cox', title:'CFO, Consumer & Community Banking', group:'Chase Management', photo:'https://media.chase.com/content/dam/chase-ux/en/structured-images/leadership/bori-cox.jpg', joinYear:2015, education:'American Univ. of Bulgaria; London School of Economics', facts:['Holds degrees from two continents: Bulgaria and the London School of Economics','Sits on the Juilliard Council ‚Äî bridging Wall Street finance with the performing arts','Selected for the Aspen Institute\'s 2025 Class of Finance Leaders Fellows'] },
  { id:'rohan-amin', name:'Rohan Amin', title:'Chief Product Officer, Chase', group:'Chase Management', photo:'https://media.chase.com/content/dam/chase-ux/en/structured-images/leadership/rohan-amin.jpg', joinYear:2010, education:'Rutgers University (PhD)', facts:['Holds a PhD ‚Äî extremely rare for a chief product officer at a major bank','Manages the daily digital experience for 71 million+ active customers','Previously CIO with a $4B tech budget; pivoted to product to get closer to the customer'] },
  { id:'gill-haus', name:'Gill Haus', title:'CIO, Consumer & Community Banking', group:'Chase Management', photo:'https://media.chase.com/content/dam/chase-ux/en/structured-images/leadership/gill-haus.jpg', joinYear:2008, education:'University of Pennsylvania', facts:['Responsible for a $7 billion annual tech budget ‚Äî larger than many tech companies\' total revenues','Leads over 12,000 technologists across multiple time zones','Has spearheaded Chase\'s shift from legacy mainframes to cloud-native systems'] },
  { id:'jennifer-roberts', name:'Jennifer Roberts', title:'CEO, Consumer Banking', group:'Chase Management', photo:'https://media.chase.com/content/dam/chase-ux/en/structured-images/leadership/jennifer-roberts.jpg', joinYear:1996, education:'Towson State; Univ. of North Texas', facts:['Has been with the firm since 1996 ‚Äî a true Chase lifer who started when the internet was young','Manages the largest branch network among all US banks ‚Äî nearly 5,000 locations','Led Chase Business Banking to #1 small business ranking in J.D. Power\'s 2020 study'] },
  { id:'kristin-lemkau', name:'Kristin Lemkau', title:'CEO, J.P. Morgan Wealth Management', group:'Chase Management', photo:'https://media.chase.com/content/dam/chase-ux/en/structured-images/leadership/kristin-lemkau.jpg', joinYear:2000, education:'Vanderbilt University', facts:['As CMO, she helped launch the Sapphire Reserve card ‚Äî which instantly sold out metal card stock in 2016','Named Forbes CMO of the Year 2019 and inducted into their CMO Hall of Fame in 2022','Made a dramatic career pivot: from leading 2,000 marketers to running a $1 trillion wealth business'] },
  { id:'sean-grzebin', name:'Sean Grzebin', title:'CEO, Chase Home Lending', group:'Chase Management', photo:'https://media.chase.com/content/dam/chase-ux/en/structured-images/leadership/sean-grzebin.jpg', joinYear:2011, education:'Univ. of Dayton; Loyola', facts:['Manages a mortgage portfolio exceeding $900 billion ‚Äî larger than the GDP of Switzerland','Became CEO of Home Lending in November 2024','Rolled out AI language models to all 14,000 home lending employees ‚Äî a landmark workplace AI deployment'] },
  { id:'peter-muriungi', name:'Peter Muriungi', title:'CEO, Connected Commerce', group:'Chase Management', photo:'https://media.chase.com/content/dam/chase-ux/en/structured-images/leadership/peter-muriungi.jpg', joinYear:2013, education:'Texas A&M; Southern Methodist University', facts:['Oversees Chase Travel ‚Äî one of the largest online travel platforms in the US','Previously led Chase Auto, serving 75% of all US franchised car dealerships','Executive Sponsor of The Fellowship Initiative, supporting young men of color in Dallas'] },
  { id:'leslie-wims-morris', name:'Leslie Wims Morris', title:'CEO, Chase Auto', group:'Chase Management', photo:'https://media.chase.com/content/dam/chase-ux/en/structured-images/leadership/leslie-wims-morris.jpg', joinYear:2018, education:'Duke University; Harvard Business School', facts:['Manages one of the largest auto loan portfolios in the United States','Serves on the board of IQVIA Holdings ‚Äî a Fortune 500 global life sciences analytics company','Joined Chase from American Express ‚Äî a classic executive pipeline between the two institutions'] }
];

// ============================================================
// QUESTIONS
// ============================================================
const POP = [
  {year:1994,event:'Kurt Cobain passed away and reshaped rock music'},
  {year:1996,event:'the Dolly the sheep cloning experiment shook the world'},
  {year:1999,event:'the world prepared for Y2K'},
  {year:2000,event:'the dot-com bubble began its dramatic burst'},
  {year:2002,event:'the first Spider-Man film launched Marvel\'s box office dominance'},
  {year:2004,event:'Facebook was founded in a Harvard dorm room'},
  {year:2005,event:'YouTube launched and changed media forever'},
  {year:2007,event:'the first iPhone was unveiled by Steve Jobs'},
  {year:2008,event:'Barack Obama was elected President for the first time'},
  {year:2010,event:'Instagram launched with a single photo filter'},
  {year:2011,event:'Steve Jobs passed away and the world mourned'},
  {year:2012,event:'Barack Obama won his second term as President'},
  {year:2013,event:'Netflix released its first original series, House of Cards'},
  {year:2014,event:'Amazon Echo and Alexa arrived in living rooms'},
  {year:2015,event:'The Force Awakened ‚Äî Star Wars returned after a decade'},
  {year:2016,event:'Pok√©mon Go became a global walking phenomenon overnight'},
  {year:2018,event:'Avengers: Infinity War made half the universe disappear'},
  {year:2020,event:'the COVID-19 pandemic reshaped every industry globally'},
  {year:2021,event:'the Great Resignation swept corporate America'},
  {year:2024,event:'the Paris Olympics returned the world to the City of Light'},
  {year:2025,event:'AI agents began running real-world business workflows'}
];

function buildQuestions() {
  let q = [];
  EXECS.forEach(e => {
    q.push({text:`Who is the ${e.title}?`, answer:e.id});
    q.push({text:`Which leader joined the firm in ${e.joinYear}?`, answer:e.id});
    q.push({text:`Which ${e.group} member goes by "${e.name.split(' ')[0]}"?`, answer:e.id});
    e.facts.forEach(f => q.push({text:`Who is known for this: "${f}"?`, answer:e.id}));
    const p = POP.find(x=>x.year===e.joinYear);
    if(p) q.push({text:`Which executive joined the firm the same year that ${p.event}?`, answer:e.id});
  });
  return q;
}
const ALL_Q = buildQuestions();

// ============================================================
// STATE
// ============================================================
let playerName='', deviceId='', currentStreak=0, bestStreak=0;
let curQ=null, curOpts=[], correctIdx=0;
let timerInt=null, timeLeft=10, gameActive=false;
let usedQ=new Set();

function getDeviceId(){
  let id=localStorage.getItem('jpm_did');
  if(!id){id='d'+Math.random().toString(36).slice(2)+Date.now().toString(36);localStorage.setItem('jpm_did',id);}
  return id;
}
function getTimeLimit(s){return s<3?10:s<6?8:s<10?6:5;}
function getDiff(s){
  if(s<3)return{label:'Easy',cls:'easy'};
  if(s<6)return{label:'Medium',cls:'medium'};
  if(s<10)return{label:'Hard',cls:'hard'};
  return{label:'Extreme',cls:'extreme'};
}

// ============================================================
// STORAGE
// ============================================================
async function getBoard(){
  try{
    const r=await window.storage.list('lb:',true);
    if(!r||!r.keys)return[];
    const out=[];
    for(const k of r.keys){try{const x=await window.storage.get(k,true);if(x)out.push(JSON.parse(x.value));}catch(e){}}
    return out.sort((a,b)=>b.score-a.score);
  }catch(e){return[];}
}
async function saveScore(name,score){
  try{
    const key='lb:'+deviceId;
    let ex=null;
    try{const r=await window.storage.get(key,true);if(r)ex=JSON.parse(r.value);}catch(e){}
    if(!ex||score>ex.score){await window.storage.set(key,JSON.stringify({name,score,deviceId,ts:Date.now()}),true);}
  }catch(e){}
}
async function getMyBest(){
  try{const r=await window.storage.get('lb:'+deviceId,true);if(r)return JSON.parse(r.value).score;}catch(e){}
  return 0;
}
async function nameExists(n){
  try{const e=await getBoard();return e.some(x=>x.name.toLowerCase().trim()===n.toLowerCase().trim()&&x.deviceId!==deviceId);}
  catch(e){return false;}
}

// ============================================================
// SCREENS
// ============================================================
function showScreen(id){document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));document.getElementById('screen-'+id).classList.add('active');}

// ============================================================
// NAME
// ============================================================
async function submitName(){
  const inp=document.getElementById('name-input');
  const err=document.getElementById('name-error');
  const n=inp.value.trim();
  if(!n||n.length<2){err.textContent='Please enter a name (at least 2 characters)';return;}
  err.textContent='';
  const taken=await nameExists(n);
  if(taken){err.textContent='That name is already taken ‚Äî try another!';return;}
  playerName=n;
  localStorage.setItem('jpm_name',n);
  await goHome();
}

// ============================================================
// HOME
// ============================================================
async function goHome(){
  stopTimer();gameActive=false;currentStreak=0;
  const saved=await getMyBest();
  bestStreak=Math.max(bestStreak,saved);
  document.getElementById('home-greeting').textContent=playerName;
  document.getElementById('home-best-streak').textContent=bestStreak;
  document.getElementById('home-play-btn').textContent=bestStreak>0?'Play Again':'Play';
  showScreen('home');
  loadBoard();
}

async function loadBoard(){
  const c=document.getElementById('leaderboard-container');
  const entries=await getBoard();
  const pct=document.getElementById('percentile-section');
  if(entries.length>1&&bestStreak>0){
    const below=entries.filter(e=>e.score<bestStreak).length;
    document.getElementById('percentile-num').textContent=Math.round(below/entries.length*100);
    pct.style.display='flex';
  } else {pct.style.display='none';}
  if(!entries.length){c.innerHTML='<div class="lb-empty">No scores yet ‚Äî be the first!</div>';return;}
  const top=entries.slice(0,10);
  const inTop=top.some(e=>e.deviceId===deviceId);
  if(!inTop){const me=entries.find(e=>e.deviceId===deviceId);if(me)top.push(me);}
  let html=`<div class="lb-header"><span>Player</span><span style="margin-right:auto;margin-left:12px;opacity:0">‚Äî</span><span>Best</span></div>`;
  top.forEach(entry=>{
    const rank=entries.findIndex(e=>e.deviceId===entry.deviceId)+1;
    const isMe=entry.deviceId===deviceId;
    const rankMark=rank<=3?['ü•á','ü•à','ü•â'][rank-1]:rank;
    const d=new Date(entry.ts).toLocaleDateString('en-US',{month:'short',day:'numeric'});
    html+=`<div class="lb-row${isMe?' current-user':''}">
      <span class="lb-rank${rank<=3?' top-3':''}">${rankMark}</span>
      <span class="lb-name${isMe?' me':''}">${esc(entry.name)}${isMe?' (you)':''}</span>
      <span class="lb-score">${entry.score}</span>
      <span class="lb-date">${d}</span>
    </div>`;
  });
  c.innerHTML=html;
}
function esc(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

// ============================================================
// GAME
// ============================================================
function startGame(){currentStreak=0;usedQ=new Set();gameActive=true;loadQ();showScreen('game');}

function loadQ(){
  stopTimer();
  let pool=ALL_Q.filter(q=>!usedQ.has(q.text+q.answer));
  if(!pool.length){usedQ.clear();pool=ALL_Q;}
  curQ=pool[Math.floor(Math.random()*pool.length)];
  usedQ.add(curQ.text+curQ.answer);

  const ans=EXECS.find(e=>e.id===curQ.answer);
  let wrongPool=EXECS.filter(e=>e.id!==ans.id);
  const d=getDiff(currentStreak);
  if(d.cls==='hard'||d.cls==='extreme'){
    const sg=wrongPool.filter(e=>e.group===ans.group);
    if(sg.length)wrongPool=sg;
  }
  const wrong=wrongPool[Math.floor(Math.random()*wrongPool.length)];
  correctIdx=Math.random()<0.5?0:1;
  curOpts=correctIdx===0?[ans,wrong]:[wrong,ans];

  document.getElementById('game-streak-num').textContent=currentStreak;
  document.getElementById('question-text').textContent=curQ.text;
  const diff=getDiff(currentStreak);
  const db=document.getElementById('diff-badge');
  db.textContent=diff.label;db.className='diff-badge '+diff.cls;

  curOpts.forEach((exec,i)=>{
    const img=document.getElementById('photo-img-'+i);
    const nm=document.getElementById('photo-name-'+i);
    const card=document.getElementById('photo-card-'+i);
    card.className='photo-card';card.style.pointerEvents='auto';
    img.src=exec.photo;
    img.onerror=()=>{img.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(exec.name)}&size=400&background=1e3560&color=c8a96e&font-size=0.28`;};
    nm.textContent=exec.name;
  });

  timeLeft=getTimeLimit(currentStreak);
  updateTimer(timeLeft,timeLeft);
  timerInt=setInterval(()=>{
    timeLeft--;updateTimer(timeLeft,getTimeLimit(currentStreak));
    if(timeLeft<=0){stopTimer();handleWrong();}
  },1000);
}

function updateTimer(t,max){
  document.getElementById('timer-num').textContent=t;
  const arc=document.getElementById('timer-arc');
  arc.style.strokeDashoffset=113.1*(1-t/max);
  arc.style.stroke=t>max*.5?'#3b82f6':t>max*.25?'#ed8936':'#e53e3e';
}

function stopTimer(){if(timerInt){clearInterval(timerInt);timerInt=null;}}

async function selectPhoto(idx){
  if(!gameActive)return;
  stopTimer();gameActive=false;
  [0,1].forEach(i=>document.getElementById('photo-card-'+i).style.pointerEvents='none');
  if(idx===correctIdx){
    document.getElementById('photo-card-'+idx).classList.add('ok');
    await delay(300);handleCorrect();
  } else {
    document.getElementById('photo-card-'+idx).classList.add('bad');
    document.getElementById('photo-card-'+correctIdx).classList.add('ok');
    await delay(400);handleWrong();
  }
}

function delay(ms){return new Promise(r=>setTimeout(r,ms));}

function handleCorrect(){
  currentStreak++;
  const ans=EXECS.find(e=>e.id===curQ.answer);
  document.getElementById('correct-sub').textContent=`That's ${ans.name} ‚Äî ${ans.title}.`;
  document.getElementById('correct-streak').textContent=currentStreak;
  launchConfetti();showScreen('correct');
}

async function handleWrong(){
  const prev=currentStreak;
  if(prev>0){await saveScore(playerName,prev);bestStreak=Math.max(bestStreak,prev);}
  document.getElementById('wrong-streak-num').textContent=prev;
  const ans=EXECS.find(e=>e.id===curQ.answer);
  const img=document.getElementById('correct-person-img');
  img.src=ans.photo;
  img.onerror=()=>{img.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(ans.name)}&size=200&background=1e3560&color=c8a96e`;};
  document.getElementById('correct-person-name').textContent=ans.name;
  document.getElementById('correct-person-title').textContent=ans.title;
  currentStreak=0;showScreen('wrong');
}

function nextQuestion(){gameActive=true;showScreen('game');loadQ();}

// ============================================================
// CONFETTI
// ============================================================
function launchConfetti(){
  const c=document.getElementById('confetti-container');c.innerHTML='';
  const cols=['#1a56db','#c8a96e','#38a169','#e53e3e','#9f7aea','#ffffff','#ed8936'];
  for(let i=0;i<80;i++){
    const el=document.createElement('div');
    el.className='confetto';
    el.style.cssText=`left:${Math.random()*100}vw;background:${cols[Math.floor(Math.random()*cols.length)]};width:${4+Math.random()*8}px;height:${4+Math.random()*8}px;border-radius:${Math.random()>.5?'50%':'2px'};animation-duration:${1.2+Math.random()*1.6}s;animation-delay:${Math.random()*.5}s;`;
    c.appendChild(el);
  }
  setTimeout(()=>c.innerHTML='',3500);
}

// ============================================================
// TOUCH SWIPE
// ============================================================
let tx=0;
document.getElementById('photos-row').addEventListener('touchstart',e=>{tx=e.touches[0].clientX;},{passive:true});
document.getElementById('photos-row').addEventListener('touchend',e=>{
  if(!gameActive)return;
  const dx=e.changedTouches[0].clientX-tx;
  if(Math.abs(dx)>50)selectPhoto(dx<0?0:1);
});

// keyboard
document.getElementById('name-input').addEventListener('keydown',e=>{if(e.key==='Enter')submitName();});
document.addEventListener('keydown',e=>{
  if(!document.getElementById('screen-game').classList.contains('active'))return;
  if(e.key==='ArrowLeft')selectPhoto(0);
  if(e.key==='ArrowRight')selectPhoto(1);
});

// ============================================================
// INIT
// ============================================================
async function init(){
  deviceId=getDeviceId();
  const saved=localStorage.getItem('jpm_name');
  if(saved){playerName=saved;await goHome();}else{showScreen('name');}
}
init();
</script>
</body>
</html>
