<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Just People</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600;700&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#ffffff;
  --surface:#f5f7fa;
  --navy:#0f172a;
  --accent:#1e3a5f;
  --accent-light:#3b82f6;
  --text:#0f172a;
  --soft-gray:#94a3b8;
  --border:#e5e7eb;
  --success:#16a34a;
  --danger:#dc2626;
}

*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:'DM Sans',sans-serif;
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
}

.screen{
  display:none;
  min-height:100vh;
  padding:24px;
  flex-direction:column;
  align-items:center;
}
.screen.active{display:flex}

/* ---------- NAME ---------- */

.name-card{
  margin-top:120px;
  background:white;
  border:1px solid var(--border);
  border-radius:18px;
  padding:42px;
  max-width:420px;
  width:100%;
  text-align:center;
}

.game-title{
  font-family:'Playfair Display',serif;
  font-size:30px;
  margin-bottom:6px;
}

.game-subtitle{
  color:var(--soft-gray);
  margin-bottom:24px;
}

input{
  width:100%;
  padding:14px;
  border-radius:10px;
  border:1px solid var(--border);
  margin-bottom:14px;
  font-size:16px;
}

.btn{
  background:var(--navy);
  color:white;
  border:none;
  border-radius:10px;
  padding:14px 20px;
  cursor:pointer;
  font-size:15px;
}

.btn:hover{opacity:.9}

.error{color:var(--danger);font-size:13px;height:18px}

/* ---------- HOME ---------- */

.home-wrap{
  width:100%;
  max-width:520px;
}

.greeting{
  font-family:'Playfair Display',serif;
  font-size:28px;
  margin-bottom:40px;
}

.play-area{
  text-align:center;
  margin-bottom:40px;
}

.leaderboard{
  border:1px solid var(--border);
  border-radius:14px;
  overflow:hidden;
}

.lb-row{
  display:grid;
  grid-template-columns:40px 1fr 80px 100px;
  padding:12px 14px;
  border-bottom:1px solid var(--border);
  font-size:14px;
}

.lb-header{
  background:var(--surface);
  font-weight:600;
}

.percentile{
  margin-top:18px;
  text-align:center;
  color:var(--soft-gray);
}

/* ---------- GAME ---------- */

.game-top{
  width:100%;
  max-width:560px;
  display:flex;
  justify-content:space-between;
  margin-bottom:20px;
}

.timer{
  font-family:'Playfair Display',serif;
  font-size:20px;
}

.question{
  font-family:'Playfair Display',serif;
  font-size:20px;
  text-align:center;
  margin-bottom:20px;
  min-height:80px;
}

.photos{
  display:flex;
  gap:14px;
  width:100%;
  max-width:560px;
}

.card{
  flex:1;
  border:1px solid var(--border);
  border-radius:14px;
  overflow:hidden;
  background:white;
  cursor:pointer;
}

.card img{
  width:100%;
  height:320px;
  object-fit:contain;
  background:#f1f5f9;
}

.card-name{
  text-align:center;
  padding:10px;
  font-size:14px;
}

.hint{
  margin-top:10px;
  color:var(--soft-gray);
  font-size:13px;
}

/* ---------- RESULT ---------- */

.result{
  text-align:center;
  margin-top:140px;
}

.result h2{
  font-family:'Playfair Display',serif;
  font-size:32px;
  margin-bottom:12px;
}

.streak{
  font-size:48px;
  font-family:'Playfair Display',serif;
  margin:18px 0;
}

/* confetti */
.confetti{
  position:fixed;
  inset:0;
  pointer-events:none;
}
.confetto{
  position:absolute;
  width:8px;
  height:8px;
  animation:fall 2s linear forwards;
}
@keyframes fall{
  to{transform:translateY(110vh) rotate(720deg);opacity:0}
}
</style>
</head>

<body>

<!-- NAME -->
<div id="screen-name" class="screen active">
  <div class="name-card">
    <h1 class="game-title">Just People</h1>
    <p class="game-subtitle">Learn the people behind the stories.</p>
    <input id="name-input" placeholder="Enter your name"/>
    <div id="name-error" class="error"></div>
    <button class="btn" onclick="submitName()">Continue</button>
  </div>
</div>

<!-- HOME -->
<div id="screen-home" class="screen">
  <div class="home-wrap">
    <div id="greeting" class="greeting"></div>

    <div class="play-area">
      <button id="play-btn" class="btn" onclick="startGame()">Play</button>
    </div>

    <div id="leaderboard" class="leaderboard"></div>
    <div id="percentile" class="percentile"></div>
  </div>
</div>

<!-- GAME -->
<div id="screen-game" class="screen">
  <div class="game-top">
    <div>Streak: <strong id="streak-num">0</strong></div>
    <div class="timer" id="timer">10</div>
  </div>

  <div id="question" class="question"></div>

  <div class="photos" id="photos"></div>
  <div class="hint">Swipe ← or → (or tap)</div>
</div>

<!-- CORRECT -->
<div id="screen-correct" class="screen">
  <div class="result">
    <h2>Correct.</h2>
    <div class="streak" id="correct-streak"></div>
  </div>
</div>

<!-- WRONG -->
<div id="screen-wrong" class="screen">
  <div class="result">
    <h2>Better next time.</h2>
    <button class="btn" onclick="goHome()">Back Home</button>
  </div>
</div>

<div id="confetti" class="confetti"></div>

<script>

/* ---------------- DATA (example subset) ---------------- */

const PEOPLE=[
{id:'1',name:'Jamie Dimon',title:'CEO',join:2005,
photo:'https://upload.wikimedia.org/wikipedia/commons/3/3c/Jamie_Dimon_2013.jpg',
facts:['Writes influential shareholder letters']},

{id:'2',name:'Mary Callahan Erdoes',title:'Asset Management CEO',join:1996,
photo:'https://upload.wikimedia.org/wikipedia/commons/0/0a/Mary_Callahan_Erdoes.jpg',
facts:['Oversees trillions in client assets']}
];

const POP=[
{year:2005,event:'YouTube launched'},
{year:1996,event:'Dolly the sheep was cloned'}
];

/* ---------------- STATE ---------------- */

let playerName='';
let deviceId='';
let streak=0;
let bestScore=0;
let curAnswer=null;
let timerInt=null;
let timeLeft=10;

/* ---------------- STORAGE ---------------- */

function getDeviceId(){
 let id=localStorage.getItem('jp_device');
 if(!id){
   id='d'+Math.random().toString(36).slice(2);
   localStorage.setItem('jp_device',id);
 }
 return id;
}

function getBoard(){
 return JSON.parse(localStorage.getItem('jp_board')||'[]');
}

function saveScore(score){
 let board=getBoard();
 let existing=board.find(x=>x.deviceId===deviceId);
 if(!existing||score>existing.score){
   board=board.filter(x=>x.deviceId!==deviceId);
   board.push({name:playerName,score,deviceId,ts:Date.now()});
 }
 localStorage.setItem('jp_board',JSON.stringify(board));
}

/* ---------------- SCREENS ---------------- */

function show(id){
 document.querySelectorAll('.screen')
   .forEach(s=>s.classList.remove('active'));
 document.getElementById(id).classList.add('active');
}

/* ---------------- NAME ---------------- */

function submitName(){
 const n=document.getElementById('name-input').value.trim();
 const err=document.getElementById('name-error');

 if(n.length<2){err.textContent='Enter a valid name';return;}

 const taken=getBoard()
   .some(x=>x.name.toLowerCase()===n.toLowerCase());

 if(taken){err.textContent='Name already taken';return;}

 playerName=n;
 localStorage.setItem('jp_name',n);
 goHome();
}

/* ---------------- HOME ---------------- */

function goHome(){
 streak=0;
 renderHome();
 show('screen-home');
}

function renderHome(){
 document.getElementById('greeting').textContent=`Hi, ${playerName}!`;

 const board=getBoard()
   .sort((a,b)=>b.score-a.score);

 const me=board.find(x=>x.deviceId===deviceId);
 bestScore=me?me.score:0;

 document.getElementById('play-btn')
   .textContent=bestScore?'Play Again':'Play';

 let html=`<div class="lb-row lb-header">
 <div>#</div><div>Player</div><div>Score</div><div>Date</div></div>`;

 board.slice(0,10).forEach((e,i)=>{
   const d=new Date(e.ts).toLocaleDateString();
   html+=`<div class="lb-row">
   <div>${i+1}</div>
   <div>${e.name}${e.deviceId===deviceId?' (you)':''}</div>
   <div>${e.score}</div>
   <div>${d}</div>
   </div>`;
 });

 document.getElementById('leaderboard').innerHTML=html;

 if(board.length>1&&bestScore){
   const below=board.filter(x=>x.score<bestScore).length;
   const pct=Math.round(below/board.length*100);
   document.getElementById('percentile')
     .textContent=`You are better than ${pct}% of players`;
 }else{
   document.getElementById('percentile').textContent='';
 }
}

/* ---------------- GAME ---------------- */

function startGame(){
 streak=0;
 nextQuestion();
 show('screen-game');
}

function buildQuestion(){
 const p=PEOPLE[Math.floor(Math.random()*PEOPLE.length)];
 const pop=POP.find(x=>x.year===p.join);

 return {
   text:`Which person joined the same year that ${pop.event}?`,
   answer:p
 };
}

function nextQuestion(){

 clearInterval(timerInt);

 const q=buildQuestion();
 curAnswer=q.answer;

 document.getElementById('question').textContent=q.text;
 document.getElementById('streak-num').textContent=streak;

 const wrong=PEOPLE.find(x=>x.id!==curAnswer.id);
 const opts=Math.random()<.5?[curAnswer,wrong]:[wrong,curAnswer];

 const container=document.getElementById('photos');
 container.innerHTML='';

 opts.forEach((p,i)=>{
   const el=document.createElement('div');
   el.className='card';
   el.onclick=()=>choose(p.id===curAnswer.id);
   el.innerHTML=`
     <img src="${p.photo}">
     <div class="card-name">${p.name}</div>`;
   container.appendChild(el);
 });

 timeLeft=10;
 document.getElementById('timer').textContent=timeLeft;

 timerInt=setInterval(()=>{
   timeLeft--;
   document.getElementById('timer').textContent=timeLeft;
   if(timeLeft<=0){
     clearInterval(timerInt);
     wrongAnswer();
   }
 },1000);
}

function choose(correct){
 clearInterval(timerInt);
 if(correct) rightAnswer();
 else wrongAnswer();
}

/* ---------------- RESULTS ---------------- */

function rightAnswer(){
 streak++;
 launchConfetti();
 document.getElementById('correct-streak').textContent=streak;
 show('screen-correct');

 setTimeout(()=>{
   show('screen-game');
   nextQuestion();
 },1500);
}

function wrongAnswer(){
 saveScore(streak);
 show('screen-wrong');
}

/* ---------------- CONFETTI ---------------- */

function launchConfetti(){
 const c=document.getElementById('confetti');
 c.innerHTML='';
 for(let i=0;i<60;i++){
   const d=document.createElement('div');
   d.className='confetto';
   d.style.left=Math.random()*100+'vw';
   d.style.background=['#1e3a5f','#3b82f6','#16a34a'][Math.floor(Math.random()*3)];
   c.appendChild(d);
 }
 setTimeout(()=>c.innerHTML='',2000);
}

/* ---------------- INIT ---------------- */

function init(){
 deviceId=getDeviceId();
 const saved=localStorage.getItem('jp_name');

 if(saved){
   playerName=saved;
   goHome();
 }else{
   show('screen-name');
 }
}

init();

</script>
</body>
</html>
